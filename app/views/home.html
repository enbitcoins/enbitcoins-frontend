<div id="home" class="container" ng-init="init()">

  <div class="row text-center">
    <h1>
      ¡Pagá <span class="text-red" typewrite text="['tus servicios', 'tus tarjetas', 'de todo']"></span> <strong>enBitcoins</strong>!
    </h1>
  </div>

  <div class="row payment-steps">
    <div class="col-md-5 col-md-offset-1 step-tab" ng-class="{active: step === 1}" ng-click="setStep(1)">
      <span class="text-blue">
        1. Empresa
      </span>
    </div>

    <div class="col-md-5 step-tab" ng-class="{active: step === 2}" ng-click="setStep(2)">
      <span class="text-blue">
        2. Detalles
      </span>
    </div>

    <div id="step1" ng-if="step === 1">
      <div ng-if="!uploadLoading">
        <div class="col-md-5 col-md-offset-1 text-center">
          <ui-select ng-model="company.selected" theme="bootstrap" ng-disabled="disabled">
            <ui-select-match placeholder="Buscar una empresa">
              {{$select.selected.name}}
            </ui-select-match>
            <ui-select-choices repeat="comp in companies" refresh="refreshCompanies($select.search)" refresh-delay="0">
              <div ng-bind-html="comp.name | highlight: $select.search"></div>
            </ui-select-choices>
          </ui-select>
        </div>

        <div class="col-md-5 text-center">
          <div class="btn btn-success btn-lg btn-block btn-upload" upload-button url="https://api.enbitcoins.com/v1/upload?country={{$root.country.slug}}" param="file" data="formData" accept="image/*,application/pdf" required="true" on-upload="onUpload(files)" on-success="onSuccess(response)" on-error="onError(response)" on-complete="onComplete(response)">Subir un archivo</div>
        </div>

        <div class="col-md-12 text-center help-text">
          <p>Selecciona una empresa de la lista ó sube una factura electrónica.</p>
        </div>
      </div>

      <div class="col-md-10 col-md-offset-1" ng-if="uploadLoading">
        <div class="progress">
          <div class="progress-bar progress-bar-success progress-bar-striped active" style="width: 100%;">
            Subiendo archivo...
          </div>
        </div>
      </div>
    </div>

    <div id="step2" ng-if="step === 2">
      <form name="paymentForm" ng-submit="confirm()">
        <div class="col-md-5 col-md-offset-1">
          <div class="form-group">
            <label for="amount">Monto</label>
            <div class="input-group">
              <span class="input-group-addon">$</span>
              <input type="number" class="form-control input-lg" id="amount" ng-model="payment.amount" tabindex="1" required>
            </div>
          </div>

          <div class="form-group">
            <label for="email">
              Email <small class="text-muted">(opcional)</small>
              <i class="fa fa-question-circle text-blue" popover="Dirección de correo electrónico para recibir notificaciones sobre el estado de su pago." popover-trigger="mouseenter"></i>
            </label>
            <div class="input-group">
              <span class="input-group-addon">@</span>
              <input type="email" class="form-control input-lg" ng-model="payment.email" tabindex="3">
            </div>
          </div>
        </div>

        <div class="col-md-5">
          <div class="form-group">
            <label for="code">
              {{company.selected.pay_data_name || 'Código'}}
              <i class="fa fa-question-circle text-blue" popover="{{company.selected.pay_data_help}}" popover-trigger="mouseenter"></i>
            </label>
            <div class="input-group">
              <span class="input-group-addon">#</span>
              <input type="text" class="form-control input-lg" ng-model="payment.code" tabindex="2" required>
            </div>
          </div>

          <div class="form-group">
            <label for="pin">
              PIN <small class="text-muted">(opcional)</small>
              <i class="fa fa-question-circle text-blue" popover="Ingrese un PIN para restringir el acceso a los datos de su pago." popover-trigger="mouseenter"></i>
            </label>
            <div class="input-group">
              <span class="input-group-addon">
                <i class="fa fa-lock"></i>
              </span>
              <input type="number" class="form-control input-lg" ng-model="payment.pin" tabindex="4">
            </div>
          </div>
        </div>

        <div class="col-md-10 col-md-offset-1">
          <button type="submit" class="btn btn-lg btn-success btn-block" ng-disabled="paymentForm.$invalid || sending">
            Confirmar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
